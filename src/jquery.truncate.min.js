!function(t){var e=function(e,n){var a=t(e),l=this,o=t.extend({max:100,collapsed:!0,toggleBtnTitle:function(t,e,n){return t?e-n+" more...":"hide "+(e-n)}},n||{}),i={collapsed:!1,toggleBtn:null,type:null,TYPE_LIST:"list",TYPE_TEXT:"text",text:null};this.toggle=function(t){i.collapsed=!i.collapsed,l.applyCollapse(t)},this.applyCollapse=function(e){if(i.collapsed){switch(i.type){case i.TYPE_LIST:e?a.find("li:not(.truncate-toggle):gt("+o.max+")").each(function(e){t(this).delay(5*e).fadeOut(3)}):a.find("li:not(.truncate-toggle):gt("+o.max+")").hide();break;case i.TYPE_TEXT:e?t({count:i.text.length}).animate({count:o.max},{duration:1e3,step:function(){a.find("span:not(.truncate-toggle)").first().text(i.text.substring(0,Math.round(this.count)))}}):a.find("span:not(.truncate-toggle)").first().text(i.text.substring(0,o.max))}i.toggleBtn.find("a").html(l.getTitle())}else switch(i.toggleBtn.find("a").html(l.getTitle()),i.type){case i.TYPE_LIST:e?a.find("li:not(.truncate-toggle):gt("+o.max+")").each(function(e){t(this).delay(10*e).fadeIn(10)}):a.find("li:not(.truncate-toggle):gt("+o.max+")").show();break;case i.TYPE_TEXT:e?t({count:o.max}).animate({count:i.text.length},{duration:1e3,step:function(){a.find("span:not(.truncate-toggle)").first().text(i.text.substring(0,Math.round(this.count)))}}):a.find("span:not(.truncate-toggle)").first().text(i.text)}},this.getTitle=function(){var t=0;switch(i.type){case i.TYPE_LIST:t=a.find("li:not(.truncate-toggle)").length;break;case i.TYPE_TEXT:t=a.text().length}return o.toggleBtnTitle(i.collapsed,t,o.max)};var g=function(){switch(i.type=a.is("ul")?i.TYPE_LIST:a.find("span").length?i.TYPE_TEXT:null,i.type){case i.TYPE_LIST:i.toggleBtn=t('<li class="truncate-toggle"><a href="#">more...</a></li>'),i.collapsed=o.collapsed,a.append(i.toggleBtn),i.toggleBtn.on("click",function(t){t.preventDefault(),t.stopPropagation(),l.toggle(!0)}),l.applyCollapse();break;case i.TYPE_TEXT:i.text=a.find("span").first().text(),i.toggleBtn=t('<span class="truncate-toggle"><a href="#">...</a></span>'),i.collapsed=o.collapsed,a.append(i.toggleBtn),i.toggleBtn.on("click",function(t){t.preventDefault(),t.stopPropagation(),l.toggle(!0)}),l.applyCollapse();break;default:throw"Element "+a.prop("tagName")+" is not supported!"}};g()};t.fn.truncate=function(n){return this.each(function(){var a=t(this);if(!a.data("truncatePlugin")){var l=new e(this,n);a.data("truncatePlugin",l)}})}}(jQuery);
